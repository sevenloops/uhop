<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" width="980" height="560" viewBox="0 0 980 560">
  <title>UHOP Architecture</title>
  <defs>
    <style type="text/css"><![CDATA[
      .box { fill: #ffffff; stroke: #1f2937; stroke-width: 2; rx: 8; ry: 8; }
      .group { fill: #f3f4f6; stroke: #9ca3af; stroke-width: 2; rx: 12; ry: 12; }
      .label { font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif; font-size: 16px; fill: #111827; }
      .sublabel { font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif; font-size: 13px; fill: #374151; }
      .arrow { stroke: #374151; stroke-width: 2; marker-end: url(#arrowhead); }
    ]]></style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#374151" />
    </marker>
  </defs>

  <!-- Groups -->
  <rect class="group" x="40" y="40" width="360" height="210" />
  <text class="label" x="60" y="68">Frontend Portal (Vite + React)</text>

  <rect class="group" x="400" y="40" width="540" height="210" />
  <text class="label" x="420" y="68">Backend API (Node/Express + WebSocket)</text>

  <rect class="group" x="40" y="300" width="440" height="220" />
  <text class="label" x="60" y="328">Local Agent (Python)</text>

  <rect class="group" x="500" y="300" width="440" height="220" />
  <text class="label" x="520" y="328">Server Runtime (Python)</text>

  <!-- Frontend boxes -->
  <rect class="box" x="60" y="90" width="150" height="60" />
  <text class="sublabel" x="75" y="120">Controls</text>
  <text class="sublabel" x="75" y="140">(benchmarks)</text>

  <rect class="box" x="230" y="90" width="150" height="60" />
  <text class="sublabel" x="245" y="120">Live Logs</text>
  <text class="sublabel" x="245" y="140">(WebSocket)</text>

  <!-- Backend boxes -->
  <rect class="box" x="420" y="90" width="200" height="60" />
  <text class="sublabel" x="435" y="120">REST: /info /demo</text>
  <text class="sublabel" x="435" y="140">/generate-kernel</text>

  <rect class="box" x="640" y="90" width="280" height="60" />
  <text class="sublabel" x="655" y="120">WS: /agent (pairing, jobs, logs)</text>

  <!-- Agent boxes -->
  <rect class="box" x="60" y="350" width="180" height="70" />
  <text class="sublabel" x="75" y="380">WS Client</text>
  <text class="sublabel" x="75" y="400">(secure token)</text>

  <rect class="box" x="260" y="350" width="200" height="70" />
  <text class="sublabel" x="275" y="376">UHOP Core</text>
  <text class="sublabel" x="275" y="396">detect, backends, cache</text>

  <rect class="box" x="260" y="440" width="200" height="60" />
  <text class="sublabel" x="275" y="470">AI Codegen (optional)</text>

  <!-- Server UHOP boxes -->
  <rect class="box" x="520" y="350" width="200" height="70" />
  <text class="sublabel" x="535" y="376">UHOP Core</text>
  <text class="sublabel" x="535" y="396">detect, backends, cache</text>

  <rect class="box" x="740" y="350" width="180" height="70" />
  <text class="sublabel" x="755" y="380">AI Codegen (optional)</text>

  <!-- Arrows -->
  <line class="arrow" x1="210" y1="120" x2="420" y2="120" />
  <line class="arrow" x1="380" y1="120" x2="640" y2="120" />

  <!-- Backend to Agent preference -->
  <line class="arrow" x1="640" y1="150" x2="150" y2="350" />
  <text class="sublabel" x="300" y="245">Prefer Local Agent when connected</text>

  <!-- Backend fallback to server runtime -->
  <line class="arrow" x1="640" y1="150" x2="620" y2="350" />
  <text class="sublabel" x="640" y="260">Fallback if no Agent</text>

  <!-- Core to backends (conceptual) -->
  <text class="sublabel" x="262" y="520">Backends: CUDA / ROCm / Metal / OpenCL / Triton / CPU</text>
  <text class="sublabel" x="522" y="440">Backends: CUDA / ROCm / Metal / OpenCL / Triton / CPU</text>
</svg>
